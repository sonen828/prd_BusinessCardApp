# 名刺管理アプリ 要件定義書

**作成日:** 2025年1月17日  
**バージョン:** 4.0  
**最終更新日:** 2026年1月21日

---

## 目次

1. [プロジェクト概要](#1-プロジェクト概要)
2. [機能要件](#2-機能要件)
3. [画面一覧](#3-画面一覧)
4. [データモデル（概要）](#4-データモデル概要)
5. [非機能要件](#5-非機能要件)
6. [用語集](#6-用語集)
7. [改訂履歴](#7-改訂履歴)

---

## 1. プロジェクト概要

### 1.1 背景・課題

フリーランスや複数の組織に所属するビジネスパーソンは、以下のような名刺管理の課題を抱えている。

- 自分の法人名義で名刺交換するパターン
- ビジネスパートナーの名刺で交換するパターン
- ビジネスパートナー経由で名刺をもらうのみ（交換なし）のパターン
- 複数のビジネスパートナーが存在し、互いの存在を知られたくないケース

既存の名刺管理サービス（Eight等）では複数名刺の管理は可能だが、ビジネスパートナー間での情報の分離が難しく、完全に個人管理できるアプリが求められている。

### 1.2 目的

本プロジェクトは、複数の「顔（所属）」を持つユーザーが、それぞれの所属ごとに名刺を整理・管理できる個人向けWebアプリケーションを開発することを目的とする。

### 1.3 システム概要

| 項目 | 内容 |
|------|------|
| アプリ名称 | （仮称）マイ名刺マネージャー |
| プラットフォーム | Webアプリケーション（ブラウザ対応） |
| データ保存方式 | ローカル保存（ブラウザのIndexedDB）※名刺データ・画像はローカルに保持 |
| 外部API利用 | OCR処理、AI構造化処理、会社情報補完等で外部APIを利用 |
| 認証方式 | ID/パスワード認証（将来的にGoogle認証等に拡張予定） |
| 対象ユーザー | フリーランス、複数組織に所属するビジネスパーソン |
| 主要機能 | 認証、名刺OCR（AI）、所属別管理、タグ、フィルター、ソート、検索、バックアップ |

---

## 2. 機能要件

### 2.1 認証機能

アプリケーションへのアクセスを制限し、ユーザーのデータを保護する機能。

| 機能ID | 機能名 | 説明 |
|--------|--------|------|
| F-001 | ユーザー登録 | ID（メールアドレス）とパスワードでアカウント作成 |
| F-002 | ログイン | ID/パスワードによる認証 |
| F-003 | ログアウト | セッションを終了してログイン画面に戻る |
| F-004 | パスワード変更 | ログイン後にパスワードを変更 |
| F-005 | セッション管理 | 一定時間操作がない場合は自動ログアウト（警告表示付き） |
| F-006 | アカウント削除 | ユーザー自身によるアカウントと全データの削除 |

#### 2.1.1 パスワード要件

| 項目 | 要件 |
|------|------|
| 最小文字数 | 8文字以上 |
| 文字種 | 英字大文字・小文字・数字を各1文字以上含む |
| 禁止パターン | メールアドレスと同一、連続した同一文字3文字以上 |

#### 2.1.2 セッション管理仕様

| 項目 | 仕様 |
|------|------|
| デフォルトタイムアウト | 30分（ユーザー設定で15分/30分/60分/無制限から選択可能） |
| タイムアウト警告 | 残り5分でモーダル表示「セッションが切れます。延長しますか？」 |
| 自動延長 | ユーザー操作（クリック、入力、スクロール）ごとにタイムアウトをリセット |

#### 2.1.3 将来拡張（Phase2以降）

- Google認証（OAuth 2.0）との連携
- その他ソーシャルログイン（Apple ID等）
- 二要素認証
- パスワードリセット機能

### 2.2 自分の所属（顔）管理機能

ユーザー自身が持つ複数の「顔」（所属・肩書き）を登録・管理する機能。

| 機能ID | 機能名 | 説明 |
|--------|--------|------|
| F-101 | 所属登録 | 自分の所属情報（会社名、肩書き、連絡先等）を登録 |
| F-102 | 名刺画像登録 | 自分の名刺画像をアップロードして所属に紐付け |
| F-103 | 所属編集 | 登録済みの所属情報を編集 |
| F-104 | 所属削除 | 所属を削除（紐付く名刺の処理を選択） |
| F-105 | 所属一覧表示 | 登録済みの所属を一覧表示 |
| F-106 | 所属並び替え | ドラッグ&ドロップで表示順を変更 |
| F-107 | 在籍期間登録 | 所属ごとに入社日（自）・退社日（至）・在籍中フラグを記録 |

#### 2.2.1 在籍期間の仕様

| 項目 | 内容 |
|------|------|
| 入社日（自） | 所属を開始した日付（任意） |
| 退社日（至） | 所属を終了した日付（任意） |
| 在籍中フラグ | ONの場合、退社日は入力不可となり「現在」と表示される |

#### 2.2.2 所属削除時の動作

| 条件 | 動作 |
|------|------|
| 紐付く名刺がある場合 | 確認ダイアログで「名刺も削除」または「別の所属に移動」を選択 |
| 最後の所属の場合 | 削除不可（最低1つの所属が必要） |

### 2.3 相手名刺管理機能

交換・取得した相手の名刺を登録・管理する機能。

| 機能ID | 機能名 | 説明 |
|--------|--------|------|
| F-201 | 名刺撮影・アップロード | カメラまたはファイルから名刺画像を取り込み |
| F-202 | OCR読取 | 名刺画像から会社名、氏名、メールアドレス等を自動抽出 |
| F-203 | 手動入力・修正 | OCR結果の修正、または手動での情報入力 |
| F-204 | 所属紐付け | どの「顔」で交換したかを紐付け |
| F-205 | 出会い情報登録 | 出会った場所、日時、きっかけ等のメモを登録 |
| F-206 | 優先度設定 | 5段階の優先度を設定（デフォルト：★★★） |
| F-207 | 名刺編集 | 登録済み名刺情報を編集 |
| F-208 | 名刺削除 | 名刺を削除（確認ダイアログ表示） |
| F-209 | 名刺一覧表示 | 所属別・優先度別などで名刺を一覧表示 |
| F-210 | 名刺画像保存 | OCR後も元の名刺画像を保持（表裏対応） |
| F-211 | 名刺画像複数登録 | 名刺の裏面やその他の画像を追加登録 |
| F-212 | 名刺詳細での画像管理 | 詳細画面から画像のアップロード・削除を直接実行 |
| F-213 | 連絡先フィールド拡張 | 携帯電話、固定電話、FAXを個別に登録・管理 |
| F-214 | リストビューからの遷移 | リストビューの氏名クリックで詳細表示（ナビゲーション改善） |

### 2.4 優先度管理機能

| レベル | ラベル | 説明 |
|--------|--------|------|
| ★★★★★ | 最重要 | 現在お取引中の大切なお客様・パートナー |
| ★★★★☆ | 重要 | 定期的にやり取りがある方 |
| ★★★☆☆ | 普通 | 今後関係が深まる可能性がある方（デフォルト） |
| ★★☆☆☆ | 低 | 機会があれば程度の関係 |
| ★☆☆☆☆ | 不要 | 忘れてよい（営業を受けただけ等） |

### 2.5 タグ機能

名刺に自由なタグを付けて、所属とは別軸で分類・整理する機能。

| 機能ID | 機能名 | 説明 |
|--------|--------|------|
| F-301 | タグ作成 | 新しいタグを作成（例：展示会、紹介、IT業界） |
| F-302 | タグ付け | 名刺に1つ以上のタグを付与 |
| F-303 | タグ編集 | タグ名・タグ色の変更 |
| F-304 | タグ削除 | タグを削除（付与済み名刺からも解除） |
| F-305 | タグ一覧表示 | 作成済みタグの一覧表示と名刺数表示 |
| F-306 | 一括タグ付け | 複数名刺を選択して一括でタグを付与 |

#### 2.5.1 タグ削除時の動作

タグを削除すると、そのタグが付与されていた名刺からタグの紐付けが解除される（名刺自体は削除されない）。

### 2.6 ソート機能

名刺一覧のカラムヘッダーをクリックすることで、データを昇順・降順にソートする機能。

| 機能ID | 機能名 | 説明 |
|--------|--------|------|
| F-401 | 登録日ソート | 名刺の登録日時で昇順/降順にソート |
| F-402 | 会社名ソート | 相手の会社名で五十音順/逆順にソート |
| F-403 | 氏名ソート | 相手の氏名で五十音順/逆順にソート |
| F-404 | 優先度ソート | 優先度の高い順/低い順にソート |
| F-405 | 交換日ソート | 名刺交換した日付で昇順/降順にソート |
| F-406 | 所属名ソート | 紐付く自分の所属名でソート |

#### 2.6.1 ソート動作仕様

| 項目 | 仕様 |
|------|------|
| 初回クリック | 昇順でソート |
| 再クリック | 降順に切り替え |
| 視覚表示 | ソート中カラムに▲（昇順）/▼（降順）アイコンを表示 |
| デフォルト | 交換日の降順（新しい順） |

### 2.7 フィルター・検索機能

名刺を様々な条件で絞り込み・検索する機能。

| 機能ID | 機能名 | 説明 |
|--------|--------|------|
| F-501 | フリーワード検索 | 会社名、氏名、メモ等を横断的に検索 |
| F-502 | 所属フィルター | 特定の所属（顔）に紐付く名刺のみ表示 |
| F-503 | 優先度フィルター | 特定の優先度の名刺のみ表示 |
| F-504 | タグフィルター | 特定のタグが付いた名刺のみ表示 |
| F-505 | 業種フィルター | 業種で絞り込み |
| F-506 | エリアフィルター | 地域（都道府県）で絞り込み |
| F-507 | 役職フィルター | 役職レベルで絞り込み |
| F-508 | 交換日フィルター | 名刺交換日の期間で絞り込み |
| F-509 | 複合フィルター | 上記条件を組み合わせた絞り込み |
| F-510 | デフォルト表示形式 | ダッシュボードの標準表示をリストビューに設定 |

#### 2.7.1 業種マスタ

| コード | 名称 |
|--------|------|
| IT | IT・通信 |
| FINANCE | 金融・保険 |
| MANUFACTURING | 製造業 |
| RETAIL | 小売・卸売 |
| SERVICE | サービス業 |
| CONSTRUCTION | 建設・不動産 |
| MEDICAL | 医療・福祉 |
| EDUCATION | 教育・研究 |
| GOVERNMENT | 官公庁・団体 |
| OTHER | その他 |

#### 2.7.2 役職レベルマスタ

| コード | 名称 | 説明 |
|--------|------|------|
| EXECUTIVE | 経営者 | 代表取締役、CEO、社長 |
| DIRECTOR | 役員 | 取締役、執行役員、CFO等 |
| MANAGER | 部長級 | 部長、本部長、ディレクター |
| SECTION_CHIEF | 課長級 | 課長、マネージャー、リーダー |
| STAFF | 担当者 | 一般社員、スタッフ |
| OTHER | その他 | フリーランス、顧問等 |

#### 2.7.3 エリアマスタ

都道府県47区分 + 海外（OVERSEAS）

### 2.8 一括操作機能

複数の名刺を選択して一括で操作する機能。

| 機能ID | 機能名 | 説明 |
|--------|--------|------|
| F-601 | 複数選択 | チェックボックスで複数名刺を選択 |
| F-602 | 全選択/全解除 | 表示中の名刺を一括で選択/解除 |
| F-603 | 一括タグ付け | 選択した名刺に一括でタグを付与 |
| F-604 | 一括エクスポート | 選択した名刺のみCSV出力 |
| F-605 | 一括削除 | 選択した名刺を一括削除（確認ダイアログ表示） |

### 2.9 重複検出・統合機能

同一人物の名刺が重複登録されていないかチェックし、統合を提案する機能。

| 機能ID | 機能名 | 説明 |
|--------|--------|------|
| F-701 | 重複検出 | 氏名・会社名・メールアドレスを基に重複候補を検出 |
| F-702 | 重複候補表示 | 重複の可能性がある名刺ペアを一覧表示 |
| F-703 | 名刺統合 | 2つの名刺を1つに統合（どちらの情報を優先するか選択） |
| F-704 | 統合スキップ | 重複ではない場合、今後の検出対象から除外 |

#### 2.9.1 重複検出条件

| 条件 | 重み | 説明 |
|------|------|------|
| メールアドレス完全一致 | 高 | 同一メールアドレス |
| 氏名＋会社名一致 | 高 | 氏名と会社名が両方一致 |
| 氏名類似＋会社名一致 | 中 | 氏名が類似（編集距離2以内）で会社名一致 |
| 電話番号一致 | 中 | 同一電話番号 |

### 2.10 エクスポート機能

| 機能ID | 機能名 | 説明 |
|--------|--------|------|
| F-801 | CSV出力 | 名刺データをCSV形式でエクスポート |
| F-802 | 所属別出力 | 特定の所属に紐付く名刺のみ出力 |
| F-803 | 選択出力 | 選択した名刺のみを出力 |
| F-804 | 出力項目選択 | 出力する項目を選択可能 |
| F-805 | 文字コード選択 | UTF-8またはShift-JISを選択可能 |

#### 2.10.1 CSV出力項目

| 項目名 | 内容 |
|--------|------|
| 氏名 | 相手の氏名 |
| ふりがな | 氏名のふりがな |
| 会社名 | 会社名 |
| 部署 | 部署名 |
| 役職 | 役職名 |
| メールアドレス | メールアドレス |
| 電話番号 | 固定電話（外線）番号 |
| 携帯番号 | 携帯電話番号 |
| FAX番号 | FAX番号 |
| 住所 | 住所 |
| 業種 | 業種名 |
| エリア | 都道府県 |
| 交換日 | 名刺交換日 |
| 交換した所属 | 紐付く所属名 |
| 優先度 | 優先度（1-5） |
| タグ | タグ名（カンマ区切り） |
| メモ | メモ内容 |
| 登録日 | 登録日時 |

### 2.11 バックアップ・復元機能

ローカル保存データの保全と復元を行う機能。

| 機能ID | 機能名 | 説明 |
|--------|--------|------|
| F-901 | フルバックアップ | 全データ（名刺、所属、タグ、設定）をJSONファイルで出力 |
| F-902 | 画像込みバックアップ | 名刺画像を含めたZIPファイルで出力 |
| F-903 | バックアップ復元 | バックアップファイルからデータを復元 |
| F-904 | 復元プレビュー | 復元前にデータ内容をプレビュー表示 |
| F-905 | 差分マージ | 既存データと復元データのマージ（上書き/追加を選択） |
| F-906 | バックアップ履歴 | 過去のバックアップ履歴を表示 |

#### 2.11.1 バックアップファイル仕様

| 項目 | 仕様 |
|------|------|
| スキーマバージョン | ファイルにバージョン番号を含む（例：1.0.0） |
| 互換性チェック | 復元時にバージョン互換性を確認 |
| 古いバージョンからの復元 | マイグレーション処理を自動実行 |
| 新しいバージョンからの復元 | エラー表示「アプリを更新してください」 |

### 2.12 自動同期機能（クラウドフォルダ連携）

ユーザーが指定したクラウド同期フォルダ（Google Drive、iCloud等）を介して、複数デバイス間でデータを自動的に同期する機能。

| 機能ID | 機能名 | 説明 |
|--------|--------|------|
| F-910 | 同期フォルダ選択 | File System Access APIでフォルダを選択 |
| F-911 | 自動保存 | データ変更時に自動的にバックアップファイルを更新 |
| F-912 | 自動読込 | アプリ起動時に同期フォルダから最新データを読込 |
| F-913 | 競合解決 | Last Write Wins方式で競合を解決 |
| F-914 | 同期状態表示 | 最終同期日時、同期中/完了状態を表示 |
| F-915 | ログイン前復元 | ログイン画面から同期フォルダを選び、アカウントとデータを復元 |

#### 2.12.1 対応ブラウザ

| ブラウザ | 対応状況 |
|----------|----------|
| Chrome / Edge | 対応（File System Access API使用） |
| Safari / Firefox | 未対応（手動バックアップが必要） |

### 2.12 ユーザー設定機能

| 機能ID | 機能名 | 説明 |
|--------|--------|------|
| F-1001 | セッションタイムアウト設定 | 自動ログアウトまでの時間を設定 |
| F-1002 | デフォルト優先度設定 | 新規名刺登録時のデフォルト優先度を設定 |
| F-1003 | 一覧表示件数設定 | 名刺一覧のページサイズを設定 |
| F-1004 | テーマ設定 | ライト/ダークテーマの切り替え |
| F-1005 | OCR言語設定 | OCRで認識する言語を設定 |
| F-1006 | APIキー設定 | 外部API（OCR、AI）のAPIキーを設定 |

### 2.13 AIエージェント機能

名刺登録・管理を支援するAI機能。

| 機能ID | 機能名 | 説明 |
|--------|--------|------|
| F-1101 | AI-OCR読取 | Google Gemini API (Multimodal LLM) による高精度な文字認識 |
| F-1102 | AI構造化抽出 | Image-to-JSONによる直接的な構造化データの抽出 |
| F-1103 | AI重複判定 | LLMによる高精度な同一人物判定 |
| F-1104 | 自然言語検索 | 自然言語での名刺検索（例：「先月会ったIT企業の人」） |
| F-1105 | 会社情報補完 | 会社名から業種・所在地等を自動補完 |
| F-1106 | タグ自動提案 | 名刺内容に基づくタグの自動提案 |
| F-1107 | 優先度自動推定 | 役職・会社規模等から優先度を自動推定 |
| F-1108 | フォールバック処理 | API障害時のローカルOCR（Tesseract.js）へのフォールバック |

#### 2.13.1 AIエージェント処理フロー

```
名刺画像アップロード
    ↓
┌─────────────────────────────────────┐
│ 1. 画像前処理                        │
│    - リサイズ、傾き補正              │
└─────────────────────────────────────┘
    ↓
┌─────────────────────────────────────┐
│ 2. OCR処理（AI-OCRスキル）           │
│    - クラウドOCR API呼び出し         │
│    - 失敗時: ローカルOCRフォールバック│
└─────────────────────────────────────┘
    ↓
┌─────────────────────────────────────┐
│ 3. 構造化処理（AI構造化スキル）      │
│    - LLMでテキスト→構造化データ      │
│    - 氏名、会社名、連絡先等を分類    │
└─────────────────────────────────────┘
    ↓
┌─────────────────────────────────────┐
│ 4. 補完処理（会社情報補完スキル）    │
│    - 会社名から業種、所在地を補完    │
│    - 役職レベルの自動分類            │
└─────────────────────────────────────┘
    ↓
┌─────────────────────────────────────┐
│ 5. 重複チェック（AI重複判定スキル）  │
│    - 既存名刺との類似度判定          │
│    - 重複候補があれば通知            │
└─────────────────────────────────────┘
    ↓
┌─────────────────────────────────────┐
│ 6. 自動提案                          │
│    - タグ提案、優先度推定            │
└─────────────────────────────────────┘
    ↓
確認・編集画面へ
```

#### 2.13.2 利用可能な外部API

| 用途 | 推奨API | 代替API |
|------|---------|---------|
| OCR & 構造化 | Google Gemini API (1.5 Pro) | Claude 3.5 Sonnet, GPT-4o |
| 会社情報 | 法人番号API（国税庁） | 企業情報API各種 |

---

## 3. 画面一覧

| 画面ID | 画面名 | 概要 |
|--------|--------|------|
| S-001 | ログイン画面 | ID/パスワード入力によるログイン |
| S-002 | ユーザー登録画面 | 新規アカウント作成 |
| S-003 | ダッシュボード | 名刺一覧、所属一覧、検索・フィルターを表示 |
| S-004 | 所属管理画面 | 自分の所属の登録・編集 |
| S-005 | 名刺登録画面 | 名刺の撮影/アップロード・OCR・編集 |
| S-006 | 名刺詳細画面 | 個別名刺の詳細表示・編集 |
| S-007 | タグ管理画面 | タグの作成・編集・削除 |
| S-008 | 重複確認画面 | 重複候補の確認・統合操作 |
| S-009 | バックアップ画面 | バックアップ・復元操作 |
| S-010 | 設定画面 | パスワード変更、各種設定、アカウント削除 |
| S-011 | CSVエクスポート画面 | CSV出力オプションの選択 |

※画面の詳細レイアウトは設計書を参照。

---

## 4. データモデル（概要）

### 4.1 主要エンティティ

| エンティティ | 説明 |
|--------------|------|
| User | ユーザー認証情報 |
| Session | セッション管理情報 |
| UserSetting | ユーザー設定情報 |
| MyProfile | 自分の所属（顔）情報 |
| BusinessCard | 相手の名刺情報 |
| BusinessCardImage | 名刺画像情報（表裏対応） |
| Tag | タグマスタ |
| CardTag | 名刺とタグの紐付け（多対多） |
| DuplicateSkip | 重複検出スキップ設定 |
| BackupHistory | バックアップ履歴 |

※各エンティティの詳細項目は設計書を参照。

---

## 5. 非機能要件

### 5.1 セキュリティ

| 項目 | 要件 |
|------|------|
| パスワード保存 | bcryptjsでハッシュ化（ソルトラウンド：10） |
| セッション管理 | IndexedDBに保存、設定可能なタイムアウト |
| データ保存 | 名刺データ・画像はローカル（IndexedDB）に保存 |
| 外部API通信 | HTTPS必須、APIキーは環境変数で管理 |
| 外部送信データ | OCR処理時は画像のみ送信、個人を特定する情報は最小限に |
| APIキー管理 | ユーザーが自身のAPIキーを設定画面で登録（ローカル保存） |

#### 5.1.1 外部API利用時のプライバシー配慮

| 項目 | 方針 |
|------|------|
| OCR処理 | 名刺画像のみ送信、メタデータは送信しない |
| AI構造化処理 | OCR結果テキストのみ送信、所属情報等は送信しない |
| 会社情報補完 | 会社名のみ送信して補完情報を取得 |
| ログ・履歴 | 外部サービスへのログ保存はユーザー同意のもと選択可能 |

### 5.2 対応ブラウザ

| ブラウザ | バージョン |
|----------|------------|
| Google Chrome | 最新版 |
| Safari | 最新版 |
| Firefox | 最新版 |
| Microsoft Edge | 最新版 |

### 5.3 パフォーマンス

| 項目 | 目標値 |
|------|--------|
| 初期表示 | 2秒以内 |
| 名刺一覧表示（1000件） | 1秒以内（仮想スクロール使用） |
| ソート・フィルター処理 | 0.5秒以内 |
| OCR処理 | 10秒以内 |
| バックアップ生成（1000件） | 30秒以内 |

### 5.4 データ容量

| 項目 | 想定値 |
|------|--------|
| 名刺1件あたりの画像サイズ | 約200KB（圧縮後） |
| 名刺1000件の総容量 | 約200MB |
| IndexedDBの上限 | ブラウザ依存（通常数GB以上） |

---

## 6. 用語集

| 用語 | 説明 |
|------|------|
| 所属（顔） | ユーザーが持つ複数のビジネス上の立場・肩書き |
| タグ | 名刺を分類するためのラベル（複数付与可能） |
| 優先度 | 名刺の重要度を5段階で表したもの |
| OCR | Optical Character Recognition（光学文字認識） |
| IndexedDB | ブラウザ内蔵のNoSQLデータベース |
| bcrypt | パスワードハッシュ化アルゴリズム |

---

## 7. 改訂履歴

| Ver | 日付 | 内容 |
|-----|------|------|
| 1.0 | 2025/01/17 | 初版作成 |
| 1.1 | 2025/01/17 | 認証機能、ソート機能を追加 |
| 1.2 | 2025/01/17 | タグ、フィルター拡充、一括操作、重複検出、バックアップ機能を追加 |
| 2.0 | 2025/01/17 | パスワード要件追加、セッション管理詳細化、削除時動作明確化、マスタデータ定義追加、CSV出力詳細化、ユーザー設定機能追加、アカウント削除機能追加、名刺画像複数対応 |
| 3.0 | 2026/01/18 | 自動同期機能（クラウドフォルダ連携）追加、ログイン前復元機能追加、所属への在籍期間記録機能追加、優先度レーティング（星5段階）のUI実装を明記 |
| 4.0 | 2026/01/21 | 電話番号フィールドの拡張（携帯/固定/FAX）、ダッシュボードのデフォルト表示をリスト形式に変更、名刺詳細からの画像アップロード/削除機能の追加、リスト表示での氏名リンク化によるナビゲーション改善 |
